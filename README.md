# PysparkConnector, KNN (Classifier, Regressor) and HierarchicalClustering for Pyspark

Мои наработки для Pyspark, которые требовались, но не были реализованы в исходной библиотеке.


Коннектор для упрощения рутины работы с Pyspark.
Пример работы и методы в ноутбуке CONNECTOR.ipynb
- Запись/чтение в postgres|clickouse|hdsf
- Оптимальное репартиционирование датаферейма и сохранение чекпоинтов
- Корректное завершение работы и очистка кэша
- Работа с графами через graphframes


Реализация KNN в спарк.
Пример работы и методы в ноутбуке KNN.ipynb
- Есть регрессия и классификация.
- Взвешенный КНН, несколько метрик для дистанции.


Иерархическая кластеризация в спарк.
1) Считаем дистанцию между центроидами.
2) Возьмем только топ 1 центроид по заданной метрике, взвешивая дистанцию на инерцию центроидов.
3) Оставляем только те, что проходят по трешхолду
4) Объединяем пары в граф без конфликтов.
5) Считаем центроид графа и инерцию.
6) Повторяем с пункта 1 до тех пор, пока количетсво кластеров за итерацию не перестанет уменьшаться. 
Пример работы и методы в ноутбуке HierarchicalClustering.ipynb
- Реализована нормализация данных: minmax, zscore.
- Останова по трешхолду дистанции между центроидами кластеров.
- Вывод последовательных результатов кластеризации по шагам.

